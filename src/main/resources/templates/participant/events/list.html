<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Events</title>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1, user-scalable=no" name="viewport"/>
    <link rel="stylesheet" th:href="@{/css/home/main.css}"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
</head>
<body class="is-preload">

<!-- Wrapper -->
<div id="wrapper">

    <!-- Main -->
    <div id="main">
        <div class="inner">
            <!-- Header -->
            <header id="header">
                <a class="logo" th:href="@{/}"><strong>EventSphere</strong> - Events</a>
            </header>

            <!-- Content -->
            <section>
                <!-- Heading -->
                <header class="major">
                    <h2 th:if="${isPast}">Past Events</h2>
                    <h2 th:unless="${isPast}">
                        <span th:if="${category}" th:text="'Events - ' + ${category}"></span>
                        <span th:unless="${category}">Upcoming Events</span>
                    </h2>
                </header>

                <!-- Filters -->
                <div class="box alt" style="margin-bottom: 2em;">
                    <div class="row gtr-50 gtr-uniform">
                        <div class="col-6 col-12-small">
                            <a th:class="${!isPast} ? 'button primary fit' : 'button fit'"
                               th:href="@{/participant/events/list}">
                                Upcoming
                            </a>
                        </div>
                        <div class="col-6 col-12-small">
                            <a th:class="${isPast} ? 'button primary fit' : 'button fit'"
                               th:href="@{/participant/events/past}">
                                Past
                            </a>
                        </div>
                        <div class="col-12" style="margin-top: 1em;">
                            <h4>Categories</h4>
                            <a th:class="'button small ' + (${category == null} ? 'primary' : '')"
                               th:href="@{/participant/events}">
                                All
                            </a>
                            <a th:class="'button small ' + (${category == cat} ? 'primary' : '')"
                               th:each="cat : ${categories}"
                               th:href="@{/participant/events(category=${cat})}"
                               th:text="${cat}">
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Events List -->
                <div class="posts">
                    <article th:each="event : ${events}">
                        <a class="image" th:href="@{/participant/events/{id}(id=${event.eventId})}">
                            <img alt="Event Image"
                                 style="width: 100%; height: 200px; object-fit: cover;"
                                 th:src="${event.imageUrl != null ? event.imageUrl : '/images/events/event-placeholder.jpg'}"/>
                        </a>
                        <h3 th:text="${event.title}">Event Title</h3>
                        <p th:text="${event.description}">Event description</p>
                        <p>
                            <i class="far fa-calendar-alt"></i>
                            <span th:text="${#temporals.format(event.startDate, 'dd MMM yyyy')} + ' at ' + 
                                           ${#temporals.format(event.startDate, 'h:mm a')}"></span>
                        </p>
                        <ul class="actions">
                            <li>
                                <a class="button" th:href="@{/participant/events/{id}(id=${event.eventId})}">
                                    View Details
                                </a>
                            </li>
                        </ul>
                    </article>
                    <article th:if="${#lists.isEmpty(events)}">
                        <p>No events found.</p>
                    </article>
                </div>

                <!-- Pagination -->
                <ul class="pagination" th:if="${events.totalPages > 1}">
                    <li>
                        <a class="button small" th:with="baseUrl=${isPast ? '/participant/events/past' : '/participant/events/list'}"
                           th:href="@{${baseUrl}(page=0, category=${category != null ? category : ''})}">
                            « First
                        </a>
                    </li>
                    <li>
                        <a th:class="${events.first} ? 'button small disabled' : 'button small'"
                           th:with="baseUrl=${isPast ? '/participant/events/past' : '/participant/events/list'}"
                           th:href="@{${baseUrl}(page=${events.number - 1}, category=${category != null ? category : ''})}">
                            ‹ Prev
                        </a>
                    </li>

                    <li th:each="i : ${#numbers.sequence(1, events.totalPages)}">
                        <a th:class="${i - 1 == events.number} ? 'button small primary' : 'button small'"
                           th:with="baseUrl=${isPast ? '/participant/events/past' : '/participant/events/list'}"
                           th:href="@{${baseUrl}(page=${i - 1}, category=${category != null ? category : ''})}"
                           th:text="${i}">
                        </a>
                    </li>

                    <li>
                        <a th:class="${events.last} ? 'button small disabled' : 'button small'"
                           th:with="baseUrl=${isPast ? '/participant/events/past' : '/participant/events/list'}"
                           th:href="@{${baseUrl}(page=${events.number + 1}, category=${category != null ? category : ''})}">
                            Next ›
                        </a>
                    </li>
                    <li>
                        <a class="button small" 
                           th:with="baseUrl=${isPast ? '/participant/events/past' : '/participant/events/list'}"
                           th:href="@{${baseUrl}(page=${events.totalPages - 1}, category=${category != null ? category : ''})}">
                            Last »
                        </a>
                    </li>
                </ul>
            </section>
        </div>
    </div>

    <!-- Sidebar -->
    <div th:replace="~{layout/sidebar-layout :: sidebar}"></div>

</div>

<!-- Scripts -->
<script th:src="@{/js/jquery.min.js}"></script>
<script th:src="@{/js/browser.min.js}"></script>
<script th:src="@{/js/breakpoints.min.js}"></script>
<script th:src="@{/js/util.js}"></script>
<script th:src="@{/js/main.js}"></script>

</body>
</html>
